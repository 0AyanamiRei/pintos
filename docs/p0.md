# Project 0: Getting Real

## Preliminaries

>Fill in your name and email address.

FirstName LastName <email@domain.example>

>If you have any preliminary comments on your submission, notes for the TAs, please give them here.



>Please cite any offline or online sources you consulted while preparing your submission, other than the Pintos documentation, course text, lecture notes, and course staff.



## Booting Pintos

>A1: Put the screenshot of Pintos running example here.



## Debugging

#### QUESTIONS: BIOS 

>B1: 第一条执行的指令是什么?

`[f000:fff0]    0xffff0: ljmp   $0x3630,$0xf000e05b` 该指令的物理地址是`0xffff0` (`0x000F0000`~`0x00100000`), 位于*BIOS ROM*区域, 指令内容是长跳转指令, 跳转到


>B2: 该指令位于内存哪个位置?

`0xffff0`



#### QUESTIONS: BOOTLOADER

>B3: BootLoader如何读取磁盘扇区的? 使用了什么BIOS中断?

`call read_sector`和`int $0x13` 

```sh
read_sector:
	pusha
	sub %ax, %ax
	push %ax			# LBA sector number [48:63]
	push %ax			# LBA sector number [32:47]
	push %ebx			# LBA sector number [0:31]
	push %es			# Buffer segment
	push %ax			# Buffer offset (always 0)
	push $1				# Number of sectors to read
	push $16			# Packet size
	mov $0x42, %ah			# Extended read
	mov %sp, %si			# DS:SI -> packet
	int $0x13			# Error code in CF
	popa				# Pop 16 bytes, preserve flags
popa_ret:
	popa
	ret				# Error code still in CF
```


>B4: BootLoader如何判断是否成功找到Pintos kernel?

```sh
第一个调用0x18中断的
no_such_drive:
no_boot_partition:
	# Didn't find a Pintos kernel partition anywhere, give up.
	call puts
	.string "\rNot found\r"

	# Notify BIOS that boot failed.  See [IntrList].
	int $0x18

第二个调用0x18中断的
read_failed:
start:
	# Disk sector read failed.
	call puts
1:	.string "\rBad read\r"

	# Notify BIOS that boot failed.  See [IntrList].
	int $0x18
```

查看*loader.S*中调用`no_such_drive`, `no_boot_partition`, `read_failed`处代码的逻辑, 就知道何时应该调用0x18中断(错误处理机制，当启动设备未找到或者启动失败时，会执行这个中断)


>B5: 当BootLoader不能找到Pintos kernel时会发生什么?



>B6: BootLoader在什么时候以及如何将控制权转移给Pintos kernel？



#### QUESTIONS: KERNEL

>B7: At the entry of pintos_init(), what is the value of expression `init_page_dir[pd_no(ptov(0))]` in hexadecimal format?



>B8: When `palloc_get_page()` is called for the first time,

>> B8.1 what does the call stack look like?
>>
>> 

>> B8.2 what is the return value in hexadecimal format?
>>
>> 

>> B8.3 what is the value of expression `init_page_dir[pd_no(ptov(0))]` in hexadecimal format?
>>
>> 



>B9: When palloc_get_page() is called for the third time,

>> B9.1 what does the call stack look like?
>>
>> 

>> B9.2 what is the return value in hexadecimal format?
>>
>> 

>> B9.3 what is the value of expression `init_page_dir[pd_no(ptov(0))]` in hexadecimal format?
>>
>> 



## Kernel Monitor

>C1: Put the screenshot of your kernel monitor running example here. (It should show how your kernel shell respond to `whoami`, `exit`, and `other input`.)

#### 

>C2: Explain how you read and write to the console for the kernel monitor.
